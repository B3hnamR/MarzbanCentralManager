# Marzban Central Manager

<p align="center">
  <strong>ابزار حرفه‌ای برای مدیریت متمرکز، پشتیبان‌گیری و مانیتورینگ شبکه‌ای از سرورهای مرزبان</strong>
  <br />
  <br />
  <a href="https://github.com/behnamrjd/MarzbanCentralManager/stargazers"><img src="https://img.shields.io/github/stars/behnamrjd/MarzbanCentralManager?style=social" alt="Stars"></a>
  <a href="https://github.com/behnamrjd/MarzbanCentralManager/issues"><img src="https://img.shields.io/github/issues/behnamrjd/MarzbanCentralManager" alt="Issues"></a>
  <br />
  <em>Made with ❤️ by behnamrjd - Thanks to all Marzban developers</em>
</p>

---

## 🚀 چرا Marzban Central Manager؟

مدیریت همزمان چندین سرور مرزبان (Node) می‌تواند به سرعت به یک کار تکراری، پیچیده و خسته‌کننده تبدیل شود. **Marzban Central Manager** این چالش را با ارائه یک پنل مدیریتی متمرکز و هوشمند در ترمینال شما حل می‌کند. این اسکریپت به شما قدرت می‌دهد تا تمام نودهای خود را از یک نقطه واحد کنترل کنید، فرآیندهای حیاتی مانند **پشتیبان‌گیری** و **همگام‌سازی** را خودکار کرده و با **مانیتورینگ مداوم**، از پایداری زیرساخت خود اطمینان حاصل کنید.

این پروژه برای مدیران سروری طراحی شده است که به دنبال **اتوماسیون، امنیت و آرامش خاطر** در مدیریت شبکه مرزبان خود هستند.

## ✨ قابلیت‌های کلیدی

-   **🖥️ مدیریت متمرکز نودها:** افزودن، حذف و ویرایش اطلاعات نودها از طریق یک منوی تعاملی و کاربرپسند.
-   **💾 سیستم پشتیبان‌گیری جامع:**
    -   بکاپ‌گیری کامل از سرور اصلی و تمام نودها (شامل Marzban, Nginx, HAProxy).
    -   **زمان‌بندی خودکار بکاپ‌های روزانه** با قابلیت تنظیم ساعت.
    -   سیاست هوشمند **حذف بکاپ‌های قدیمی** (Retention Policy) برای جلوگیری از پر شدن فضا.
-   **🔄 همگام‌سازی پیشرفته و هوشمند:**
    -   همگام‌سازی خودکار کانفیگ **HAProxy** در تمام نودها با قابلیت **بازگشت (Rollback)** در صورت بروز خطا.
    -   همگام‌سازی فایل‌های **GeoIP و Geosite** برای یکپارچگی کامل قوانین مسیریابی.
    -   امکان انتقال کاربران بین نودها.
-   **🔧 نصب و راه‌اندازی خودکار (Automated Deployment):**
    -   نصب و پیکربندی کامل یک سرور جدید به عنوان Marzban-Node **تنها با یک دستور**.
-   **📡 مانیتورینگ و اطلاع‌رسانی:**
    -   بررسی مداوم وضعیت سلامت (Online/Offline) و تطابق کانفیگ نودها.
    -   **همگام‌سازی مجدد خودکار (Auto-Resync)** برای نودهایی که کانفیگ آن‌ها با سرور اصلی تفاوت دارد.
    -   ارسال **نوتیفیکیشن تلگرام** برای رویدادهای مهم (اتمام بکاپ، خطاها، آفلاین شدن نودها).
-   **⚙️ ابزارهای تشخیصی (Diagnostics):**
    -   نمایش زنده منابع سیستم (CPU, RAM, Disk).
    -   تست اتصال شبکه و وضعیت سرویس‌های کلیدی (Docker, Nginx, HAProxy).
    -   مشاهده لاگ‌های سیستم به صورت دسته‌بندی شده.
-   **🤖 رابط کاربری هوشمند:**
    -   منوی کاملاً تعاملی و رنگی برای سهولت در استفاده.
    -   **نصب خودکار پیش‌نیازهای مورد نیاز** در اولین اجرا.
    -   سیستم لاگ‌گیری پیشرفته برای ردیابی دقیق عملیات.

## 🔒 یک نکته مهم در مورد امنیت و پسوردها

برای انجام عملیات روی نودها (مانند نصب، بکاپ و همگام‌سازی)، اسکریپت نیاز به دسترسی SSH به سرورهای شما دارد و در نتیجه، اطلاعات ورود (کاربر و پسورد) را از شما دریافت می‌کند. ما اهمیت امنیت را کاملاً درک می‌کنیم:

-   **ذخیره‌سازی محلی:** تمام اطلاعات ورود شما **فقط و فقط** روی سرور مرکزی خودتان و در مسیر `/root/MarzbanManager/marzban_managed_nodes.conf` به صورت رمزنگاری نشده (plaintext) ذخیره می‌شود.
-   **عدم انتقال اطلاعات:** اسکریپت به صورت متن‌باز (Open Source) در اختیار شماست تا بتوانید شخصاً این موضوع را بررسی کنید.
-   **مسئولیت امنیت:** مسئولیت حفاظت از سرور مرکزی (که این اسکریپت روی آن نصب است) بر عهده شماست. اطمینان حاصل کنید که این سرور به خوبی امن شده است.

## ⚙️ نصب و راه‌اندازی

۱. ابتدا پروژه را از گیت‌هاب کلون کنید:
```
git clone https://github.com/behnamrjd/MarzbanCentralManager.git
```

۲. وارد پوشه پروژه شده و اسکریپت اصلی را با دسترسی `root` اجرا کنید:
```
cd MarzbanCentralManager/MarzbanManager
chmod +x marzban_central_manager.sh
./marzban_central_manager.sh
```
در اولین اجرا، اسکریپت شما را برای انجام تنظیمات اولیه و نصب پیش‌نیازها راهنمایی می‌کند.

## 🤝 مشارکت

از مشارکت شما در این پروژه استقبال می‌شود. برای بهبود پروژه می‌توانید Pull Request ارسال کرده یا در بخش Issues مشکلات و پیشنهادات خود را ثبت کنید.

## 📜 مجوز و شرایط استفاده

این اسکریپت را برای استفاده شخصی و کمک به جامعه مرزبان نوشتم. با خیال راحت از آن استفاده کنید. اگر برایتان مفید بود، یک ستاره ⭐ در گیت‌هاب باعث دلگرمی است.
```
